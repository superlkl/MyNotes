>**若一个查询同时涉及两个表及以上的表，则称之为连接查询。**
>
>**连接查询是关系数据库中最主要的查询，包括等值连接查询、自然连接查询、非等值连接查询、自身连接查询、外连接查询和复合条件查询等**

# 等值于非等值连接查询

连接查询的where子句中用来连接两个表的条件成为连接条件或连接谓词，一般格式为

**表名1.列名1 {比较运算符} 表名2.列名2**

当连接运算符为“=”时，称之为等值连接。使用其他运算符称之为非等值连接。

连接谓词中的列名称为连接字段。连接条件中的各连接字段类型必须是可比的，但是名字不必相同

1. 查询每个学生及其选修课情况

```sql
select Student.*,SC.* from Student,SC 
where Student.Sno=SC.Sno;
```

![image-20191218175944473](连接查询.assets/image-20191218175944473.png)

学生情况放在Student表中，学生选课情况放在SC表中，所以本查询涉及两个表，这两个表之间的联系通过公共属性Sno实现

2. 对例1用自然连接完成

```sql
select student.Sno, Sname,Ssex, Sage,Sdept,Cno,Grade
from student,sc
where student.sno = sc.sno;
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191218204124553.png)



去掉Student表和SC表共同的属性列Sno，其中一个，等值连接就变成了自然连接，上述SQL保留了student的Sno

# 自身连接

连接操作不仅可以在两个表之间进行，也可以是一个表与自己进行连接，称为表的自身连接。

```sql
select c.Cno 课程号,c.Cname 课程名, c.Cpno 先行课程号 , s.Cname 先行课程名, s.Cpno 间接先行课程号
from Course c,course s 
where c.Cpno = s.Cno;
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191218204533136.png)

原来给列名起别名的时候对于字符串不用加引号都可以通过编译！

# 多表连接

```sql
select Student.Sno,Sname,Cname,Grade 
from Student,SC,Course
where Student.Sno=SC.Sno and SC.Cno=Course.Cno;
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191218205033412.png)

通常是先进行两个表的连接，再将其连接结果与第三个表进行连接

# 嵌套查询

1. 查找课程号为2的学生姓名

```sql
select Sname  /*外层查询或父查询*/
from Student
where Sno in
    (select Sno  /*内层查询或子查询*/
     from SC
     where Cno='2');  
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191218205811576.png)

首先在SC表里找到了课程号为2的学生学号，这些学号形成了一个集合

再用Student表里的学生学号判断是否和集合里的学号有相同的，如果有，则输出学生姓名

- 带有in谓词的子查询

在嵌套查询中，子查询的结果往往是一个集合，所以谓词in是嵌套查询中最经常使用的谓词

- 子查询中的select语句不能用order by子句，order by子句只能对最终查询结果排序



2. 查询与刘晨在同一个系学习的学生

思路：最终目的：找到这个学生，也就是说得到这个学生的姓名，知道他是谁

约束条件：要在同一个系

那么就先查出刘晨所在的系，再根据这个系查找其他学生的信息

```sql
select * from Student 
where Sdept in(select Sdept from Student where Sname='刘晨')
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191218210854122.png)

本例中，子查询的查询条件不依赖父查询，称为不相关子查询



3. 查询选修课程名为“信息系统”的学生学号和姓名

思路：最终目的：得到学生学号和姓名

约束条件：得是信息系统的学生

选修课程名在Course表，学生信息在Student表，两个表完全没关系，所以得依靠SC表建立关系，把SC表和Course表先连接找到信息系统的课程号，在SC表里找到课程号对应的学号，再把学号和Student表连接，输出学生信息

```sql
select  * from Student 
where Sno in(select Sno from SC 
where Cno in(select Cno from Course where Cname='信息系统')
)
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191218212116995.png)

①首先在Course关系中找出“信息系统”的课程号，结果为3号

②然后在SC关系中找出选修了3号课程的学生学号

③最后在Student关系中取出学生信息



4. 例3也可以用连接查询实现

```sql
select Student.Sno,Sname 
from Student,SC,Course
where Student.Sno=SC.Sno and
Course.Cname='信息系统'
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/2019121821270849.png)

**会有重复值出现，用distinct除去**

```sql
select distinct Student.Sno,Sname 
from Student,SC,Course
where Student.Sno=SC.Sno and
Course.Cname='信息系统'
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191218212116995.png)

有些嵌套查询可以用连接运算代替，有些是不能代替的