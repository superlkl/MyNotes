# `IP`地址

## 网络地址和主机地址

如今的[IP网络](https://www.baidu.com/s?wd=IP网络&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)使用32位地址，以[点分十进制](https://www.baidu.com/s?wd=点分十进制&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)表示，如192.168.0.1。

地址格式为：**<u>`IP`地址=网络地址+[主机地址](https://www.baidu.com/s?wd=主机地址&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)或 `IP`地址=网络地址+子网地址+[主机地址](https://www.baidu.com/s?wd=主机地址&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)</u>**。

 网络地址是因特网协会的`ICANN`分配的，下有负责北美地区的`InterNIC`、负责欧洲地区的`RIPENIC`和负责[亚太地区](https://www.baidu.com/s?wd=亚太地区&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)的`APNIC` 目的是为了保证网络地址的全球唯一性。[主机地址](https://www.baidu.com/s?wd=主机地址&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)是由各个网络的系统管理员分配。因此，网络地址的唯一性与网络内主机地址的唯一性确保了`IP`地址的全球唯一性。 

## 1. 查看网络地址 

在`cmd`窗口输入命名`ipconfig`

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127134147131.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0MjU3Mzgz,size_16,color_FFFFFF,t_70)

红框处就是自己的`ip`地址

## 2. 查看主机地址 

直接百度`IP`地址

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127133443170.png)

 `IP`地址等于就是你家的地址，必要时相关部门根据`IP`地址就可以找到你，这是最简单的理解。 

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127133453250.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0MjU3Mzgz,size_16,color_FFFFFF,t_70) 

# `IPv4`的`IP`地址

## 一、前言

  - 说起地址，大家都不陌生，现实生活中的地址都是xx省xx市xx区xx街xx小区xx栋xx楼xx室，每个地址都是唯一的，不会出现两个不同的地方地址完全一样的情况。根据一个人的居住地址，我们可以准确无误的找到这个人。
  - 在没有互联网和电话之前，相隔两地的人进行沟通主要通过信件，我们在信封上写上收件人地址，邮递员就可以通过这个地址找到收件人并把信交给他。如今已经是互联网时代，几乎每个人都有一台或多台电脑、手机设备，我们进行沟通不再需要通过信件，**<u>我们只需要在自己电脑编辑好内容就可以准确无误的发送到对方电脑上。那这到底是如何实现的呢？它是如何找到对方电脑的呢？其实这和邮递员送信件是一样的原理，每台电脑都有一个地址，也就是我们常说的`IP`地址</u>**(Internet Protocol Address，互联网协议地址)，只不过这个地址的表述方式和我们现实生活中的地址不一样。

## 二、`IP`地址的格式

  互联网发展至今，互联网协议经历了多个版本，不同的互联网协议版本`IP`地址的表述方式也不一样，我们常见的类似192.168.1.2这种格式的就是`IPv4`(Internet Protocol version 4，互联网协议版本4)。就目前来说，我们平时所说的`IP`地址就是指`IPv4`协议下的`IP`地址。**<u>`IPv4`的`IP`地址由4段组成，段之间用点隔开，每段由8位二进制数组成，所以</u><u>其范围用二进制表示就是00000000-11111111，用十进制表示就是0-255之间</u>**。所以`IP`地址由4段共32位组成，其二进制范围是00000000.00000000.00000000.00000000—11111111.11111111.11111111.11111111，**<u>十进制表示就是0.0.0.0–255.255.255.255</u>**，一共是![2^{32}](https://math.jianshu.com/math?formula=2%5E%7B32%7D)(4294967296，近43亿)个`IP`地址。

（2的32次方：二进制有0和1两个数，每段8个二进制数，共有4段组成，所以就是2的32次方个数=43亿）

## 三、`IP`地址的分类

  `IP`地址共分A、B、C、D、E五类，其中A、B、C三类`IP`地址是我们常用的`I`P地址，它包括网络地址和主机地址2个部分，我们根据网络地址和主机地址占用的位数的不同分为A、B、C三类。D类`IP`地址一般用于多点广播。E类`IP`地址是保留地址。

#### 1. A类`IP`地址

  如下图所示，A类`IP`地址的前8位是网络地址，**<u>网络地址第一位必须是0，所以有2^7=128个A类网络地址</u>**，而全0网络地址(00000000)被保留用于指定默认路由，127网络地址(01111111)被保留用于诊断，所以**<u>A类网络地址实际只有126个。</u>**

  每个A类`IP`地址的后24位表示主机地址，但由于**<u>全0和全1的主机地址被保留</u>，**所以一个A类网段最大包含![2^{24}](https://math.jianshu.com/math?formula=2%5E%7B24%7D)-2=16777214个节点。
 所以A类`IP`地址范围是1.0.0.1—126.255.255.254，可用网络有126个，每个网络能容纳16777214个主机，一般用于大型网络。

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127133536946.png)

#### 2. B类`IP`地址

  B类`IP`地址的前16位是网络地址，网络地址的前两位必须是10，所以B类网络地址共有![2^{14}](https://math.jianshu.com/math?formula=2%5E%7B14%7D)=16384个。后16位是主机地址，但全0和全1的主机地址被保留，所以每个B类网络可以容纳![2^{16}](https://math.jianshu.com/math?formula=2%5E%7B16%7D)-2=65534台主机。B类IP地址的范围是128.0.0.1-191.255.255.254(二进制为10000000.00000000.00000000.00000001 - 10111111.11111111.11111111.11111110)。B类`IP`地址一般用于中型网络。


![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127133547375.png)

#### 3. C类`IP`地址

  C类`IP`地址的前24位是网络地址，网络地址的前两位必须是110，所以C类网络地址共有![2^{21}](https://math.jianshu.com/math?formula=2%5E%7B21%7D)=2097152个。后8位是主机地址，但全0和全1的主机地址被保留，所以每个C类网络可以容纳![2^8](https://math.jianshu.com/math?formula=2%5E8)-2= 254台主机。C类`IP`地址的范围是192.0.0.1-233.255.255.254(二进制为11000000.00000000.00000000.00000001 - 11011111.11111111.11111111.11111110)。C类`IP`地址一般用于小型网络。

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127133557918.png)



#### 4. D类`IP`地址

D类`IP`地址是以`1110`开头的`IP`地址，它们不指向特定的网络，一般用于多点广播中，多点广播地址用来一次寻址一组计算机。其地址范围为224.0.0.1--239.255.255.254。


![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127133603396.png)



#### 5. E类`IP`地址

E类`IP`地址是以`1111`开头的`IP`地址，为保留地址。其地址范围为240.0.0.1--255.255.255.254。


![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127133620206.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127133631140.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0MjU3Mzgz,size_16,color_FFFFFF,t_70)

# TCP
Transmission Control Protocol
TCP 是传输控制协议，是一种面向连接的，可靠的，基于字节流的传输层协议；
与` UDP` 一样完成第四层传输层所指定的功能与职责；

## TCP 能做什么
聊天消息传输、推送；
单人语音、视频聊天；
几乎 `UDP` 能做的都能做，但需要考虑复杂性和性能的问题；
限制：无法进行广播、多播操作；

## 核心 `API`

socket()：创建无连接的，无绑定的客户端 Socket，一般用这个空的构造方法，因为连接一旦建立，其中的值就无法修改了；
bind()：绑定一个 Socket 到一个本地地址和端口上；

## TCP 连接可靠性

### 三次握手

A：你能听到我说话吗？
B：我能听到你说话，你能听到我说话吗？
A：我能听到你说话。
三次握手确定了一件事：客户端和服务端可以相互听见对方说的话，即全双工；
其中携带的随机数是必要的，在多客户端向服务端发起连接的时候，随机数充当了电话号码的角色；

> **1、客户端发送请求【寻址请求】**
> **2、服务器端收到报文请求，回应客户端【确认请求】**
> **3、客户端收到服务端的报文进行回应。【连接请求】**
> **三次握手完成，TCP客户端和服务端成功地建立连接，可以传输数据。**

### 四次挥手

A：我想和你断开连接，可以吗？
B：可以。（A 的发送流断开，B的接收流断开）
B：我想和你断开连接，可以吗？
A：可以。（B的发送流断开，A的接收流断开）

> **1、数据验证请求码**
> **2、传输结束标记**
> **3、确认结束标记**
> **4、连接断开标记**

## TCP 传输可靠性

先拆分成过个片段，再排序，发送的时候顺序发送，接收的时候顺序组装；
如果某个片段在传输过程中丢弃或超时，客户端会重发；

# `TCP`和`UDP`的区别

**区别：**

1. TCP提供的是面向连接的、可靠的数据流传输；`UDP`提供的是非面向连接的、不可靠的数据流传输。TCP提供可靠的
2. 服务，通过TCP连接传送的数据，无差错、不丢失、不重复，按序到达；`UDP`尽最大努力交付，即不保证可靠交付。
3. TCP面向字节流；`UDP`面向报文。
4. TCP连接只能是点到点的；`UDP`支持一对一、一对多、多对一和多对多的交互通信。
5. `UDP`具有较好的实时性，工作效率比TCP高，适用于对高速传输和实时性有较高的通信或广播通信。
6. TCP对系统资源要求较多，`UDP`对系统资源要求较少。TCP首部有20字节；`UDP`的首部只有8个字节。
7. TCP的逻辑通信信道是全双工的可靠信道；`UDP`的逻辑通信信道是不可靠信道。

#  网络中进程通信 

##  网络中进程之间如何通信？ 

> **我们每天打开浏览器浏览网页 时，浏览器的进程怎么与web服务器通信的？当你用`QQ`聊天时，`QQ`进程怎么与服务器或你好友所在的`QQ`进程通信？这些都得靠socket？那什么是 socket？socket的类型有哪些？还有socket的基本函数**

 本地的进程间通信`（IPC）`有很多种方式，但可以总结为下面4类： 

1. 消息传递（管道、FIFO、消息队列）
2. 同步（互斥量、条件变量、读写锁、文件和写记录锁、信号量）
3. 共享内存（匿名的和具名的）
4. 远程过程调用（`Solaris`门和`Sun RPC`） 

**进程之间如何通信？**首要解决的问题是如何唯一标识一个进程，否则通信无从谈起！在本地可以通过进程`PID`来唯一标识一个进程，但是在网络中这是行不通的。其实`TCP/IP`协议族已经帮我们解决了这个问题，网络层的“`IP`地址”可以唯一标识网络中的主机，而传输层的“协议+端口”可以唯一标识主机中的应用程序（进程）。这样利用三元组（`IP`地址，协议，端口）就可以标识网络的进程了，网络中的进程通信就可以利用这个标志与其它进程进行交互。 

使用`TCP/IP`协议的应用程序通常采用应用编程接口：UNIX BSD的套接字（socket）和UNIX System V的`TLI`（已经被淘汰），来实现网络进程之间的通信。就目前而言，**<u>几乎所有的应用程序都是采用socket，而现在又是网络时代，网络中进程通信是无处不在，这就是我为什么说“一切皆socket”</u>。** 

# 本机`Ip`和`127.0.0.1`的区别

### 简介

**<u>连接上因特网的每一台计算机都会有一个`IP`地址</u>,** 在`linux`下可以使用命令`ifconfig`来查看本机的`ip`地址（windows为`ipconfig`）, 比如我当前电脑的`ip`地址为`192.168.0.30`, 而`127.0.0.1`被称为本地环回地址`(loopback)`, **<u>本地环回地址主要用于网络软件测试以及本地机进程间通信，无论什么程序，一旦使用环回地址发送数据，协议软件立即返回，不进行任何网络传输</u>,** 127.0.0.1可以认为是计算机上的一个虚拟网卡的`ip`地址。

### 例子

假如我们有一个server/client的应用程序,client向server发送请求, server将数据返回给client, 客户端client和服务器server需要两个不同的`ip`地址。现在我们要**<u>在本地测试这个应用程序</u>**, 则我们可以将我们**<u>本地`ip`当做客户端</u>的地址,而<u>127.0.0.1当做服务器server的地址</u>, <u>客户端向127.0.0.1发送请求, 然后从127.0.0.1得到返回数据</u>。**另一个例子是假如我们本地的电脑上有一个数据库,另外一台电脑想要连接我们电脑上的数据库, 这时指定数据库时所用的地址则为本地`ip` 。

### 总结

1、本地`ip`和127.0.0.1都是`ip`地址, 只是127.0.0.1比较特殊, **<u>发送到127.0.0.1的数据或者从127.0.0.1返回的数据只会在本机进行传输, 而不进行外部网络传输;</u>**
2、127.0.0.1主要有以下两个作用

- 测试本机网络
  **<u>当我们可以ping通127.0.0.1的时候, 则说明本机的网卡以及`tcp/ip`协议族被正确安装了</u>**。
- 测试编写的网络应用
  像上面的例子一样, 我们**<u>可以将本地`ip`和127.0.0.1分别看做客户端和服务器的`ip`地址, 然后在一台电脑上完成client/server应用的测试</u>。**

3、当涉及到计算机间的网络通信时, 则使用本机`ip`。 

# 什么是ping通

 ping这个命令是用来检测你的电脑和你所输入的`IP`地址127.0.01是否有数据通讯，以判断网络通不通的问题，执行这个命令也很简单，在开始——运行，输入ping 127.0.01,上面会出现一些数据，如果你看到了out of date的字样证明是不通的。 

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127190909945.png)



#  端口号 

端口号就是具有网络功能的[应用软件](http://www.so.com/s?q=应用软件&ie=utf-8&src=internal_wenda_recommend_textn)的标识号。 

##  一、端口号的作用

当一台电脑启动了一个可以让远程其他电脑访问的程序，那么它就要**<u>开启至少一个端口号来让外界访问</u>**。我们可以把没有开启端口号的电脑看作是一个密封的房间，密封的房间当然不可能接受外界的访问，所以当系统开启了一个可以让外界访问的程序后它自然需要在房间上开一个窗口来接受来自外界的访问，这个窗口就是端口。

那么为什么要给端口编号来区分它们呢，既然一个程序开了一个端口，那么不是外部信息都可以通过这个开启的端口来访问了吗？答案是不可以。为什么呢？因为数据是用端口号来通知传输层协议送给哪个软件来处理的，数据是没有智慧的，如果很多的程序共用一个端口来接受数据的话，那么当外界的一个数据包送来后传输层就不知道该送给哪一个软件来处理，这样势必将导致混乱。

## 二、什么是端口？ 

在开始讲什么是端口（port）之前，我们先来聊一聊什么是 port 呢？常常在网络上听说『我的主机开了多少的 port ，会不会被入侵呀！？』或者是说『开那个 port 会比较安全？又，我的服务应该对应什么 port 呀！？』呵呵！很神奇吧！怎么一部主机上面有这么多的奇怪的 port 呢？这个 port 有什么作用呢？！ 

由于每种网络的服务功能都不相同，因此有必要将不同的封包送给不同的服务来处理，所以啰，当你的主机同时开启了 FTP 与 WWW 服务的时候，那么别人送来的资料封包，就会依照 TCP 上面的 port 号码来给 FTP 这个服务或者是 WWW 这个服务来处理，当然就不会搞乱啰！（注：嘿嘿！有些很少接触到网络的朋友，常常会问说：『咦！为什么你的计算机同时有 FTP、WWW、E-Mail 这么多服务，但是人家传资料过来，**<u>你的计算机怎么知道如何判断？计算机真的都不会误判吗？！』现在知道为什么了吗？！对啦！就是因为 port 不同嘛！</u>**你可以这样想啦，有一天，你要去银行存钱，那个银行就可以想成是『主机』，然后，银行当然不可能只有一种业务，里头就有相当多的窗口，那么你一进大门的时候，在门口的服务人员就会问你说：『嗨！你好呀！你要做些什么事？』你跟他说：『我要存钱呀！』，服务员接着就会告诉你：『喝！那么请前往三号窗口！那边的人员会帮您服务！』这个时候你总该不会往其它的窗口跑吧？！ 这些窗口就可以想成是『 port 』啰！所以啦！每一种服务都有特定的 port 在监听！您无须担心计算机会误判的问题呦！） 

- 每一个 TCP 联机都必须由一端(通常为 client )发起请求这个 port 通常是随机选择大于 1024 以上的 port 号来进行！其 TCP 封包会将(且只将) SYN 旗标设定起来！这是整个联机的**第一个封包**； 

- 如果另一端(通常为 Server ) 接受这个请求的话（当然啰，特殊的服务需要以特殊的 port 来进行，例如 FTP 的 port 21 ），则会向请求端送回整个联机的**第二个封包**！其上除了 SYN 旗标之外同时还将` ACK` 旗标也设定起来，并同时时在本机端建立资源以待联机之需； 
- 然后，请求端获得服务端第一个响应封包之后，**必须再响应对方一个确认封包**，此时封包只带 `ACK` 旗标(事实上，后继联机中的所有封包都必须带有 `ACK` 旗标)； 

- 只有当服务端收到请求端的确认( `ACK` )封包(也就是整个联机的第三个封包)之后，两端的联机才能正式建立。**这就是所谓的 TCP 联机的'三段式交握( Three-Way Handshake )'的原理**。 

经过三向交握之后，呵呵！你的 client 端的 port 通常是高于 1024 的随机取得的 port 至于主机端则视当时的服务是开启哪一个 port 而定，例如 WWW 选择 80 而 FTP 则以 21 为正常的联机信道！ 

总而言之,我们这里所说的端口，不是计算机硬件的I/O端口，而是软件形式上的概念.工具提供服务类型的不同，**<u>端口分为两种，一种是TCP端口，一种是`UDP`端口</u><u>。</u><u>计算机之间相互通信的时候，分为两种方式：一种是发送信息以后，可以确认信息是否到达，也就是有应答的方式，这种方式大多采用TCP协议；一种是发送以后就不管了，不去确认信息是否到达，这种方式大多采用`UDP`协议</u><u>。对应这两种协议的服务提供的端口，也就分为TCP端口和`UDP`端口。</u>** 

那么，如果攻击者使用软件扫描目标计算机，得到目标计算机打开的端口，也就了解了目标计算机提供了那些服务。我们都知道，提供服务就一定有服务软件的漏洞，根据这些，攻击者可以达到对目标计算机的初步了解。如果计算机的端口打开太多，而管理者不知道，那么，有两种情况：一种是提供了服务而管理者没有注意，比如安装IIS的时候，软件就会自动增加很多服务，而管理员可能没有注意到；一种是服务器被攻击者安装木马，通过特殊的端口进行通信。这两种情况都是很危险的，说到底，就是管理员不了解服务器提供的服务，减小了系统安全系数。 

##  三、端口号范围 

**1~65535**

##  四、端口概念 

在网络技术中，**<u>端口（Port）大致有两种意思：一是物理意义上的端口</u>**，比如，`ADSL Modem`、集线器、交换机、路由器用于连接其他网络设备的接口，如RJ-45端口、SC端口等等。**<u>二是逻辑意义上的端口，一般是指`TCP/IP`协议中的端口，端口号的范围从0到65535，比如用于浏览网页服务的80端口，用于FTP服务的21端口等等</u>**。

我们这里将要介绍的就是逻辑意义上的端口。我们这里所说的端口，不是计算机硬件的I/O端口，而是软件形式上的概念.工具提供服务类型的不同，**<u>端口分为两种，一种是TCP端口，一种是`UDP`端口</u>**。计算机之间相互通信的时候，分为两种方式：一种是发送信息以后，可以确认信息是否到达，也就是有应答的方式，这种方式大多采用TCP协议；一种是发送以后就不管了，不去确认信息是否到达，这种方式大多采用`UDP`协议。对应这两种协议的服务提供的端口，也就分为`TCP`端口和`UDP`端口。 

## 五、 查看端口 

输入命令`netstat -an`

可以看到以数字形式显示的`TCP`和`UDP`连接的端口号及状态。

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191127204117251.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0MjU3Mzgz,size_16,color_FFFFFF,t_70)

## 六、 **网络端口的分类** 

 **按端口号可分为3大类** 

###  1.公认端口 

 （`Well-KnownPorts`）：范围从0到1023 

它们紧密绑定（binding）于一些服务。通常这些端口的通讯明确表明了某种服务的协议。例如：21端口分配给FTP服务，25端口分配给SMTP（简单邮件传输协议）服务，80端口分配给HTTP服务，135端口分配给`RPC`（远程过程调用）服务等等。

**<u>我们在IE的地址栏里输入一个网址的时候（ 比如`www.cce.com.cn`）是不必指定端口号的，因为在默认情况下WWW服务的端口 号是“80”。</u>** 
网络服务是可以使用其他端口号的，**<u>如果不是默认的端口号则应该在地址栏上指定端口号，方法是在地址后面加上冒号“:”（半角），再加上端口号**。</u>比如使用“8080”作为WWW服务的端口，则需要在地址栏里输入“www.cce.com.cn:8080”。 
但是**<u>有些系统协议使用固定的端口号，它是不能被改变的</u>**，比如139 端口专门用于`NetBIOS`与`TCP/IP`之间的通信，不能手动改变。 

###  2.动态端口 

Dynamic Ports）：范围从1024到65535 

之所以称为动态端口，是因为它 一般不固定分配某种服务，而是动态分配。**<u>动态分配是指当一个系统进程或应用 程序进程需要网络通信时，它向主机申请一个端口，主机从可用的端口号中分配 一个供它使用。当这个进程关闭时，同时也就释放了所占用的端口号</u>。** 

#### 2.1注册端口 

从1024到49151。它们松散地绑定于一些服务。也就是说有许多服务绑定于这些端口，这些端口同样用     于许多其它目的。例如：许多系统处理动态端口从1024左右开始。 

####  2.2动态和/或私有端口 

(`Dynamicand/orPrivatePorts`）： 从49152到65535。

理论上，不应为服务分配这些端口。实际上，机器通常从1024   起分配动态端口。但也有例外：`SUN`的`RPC`端口从32768开始。 

#  FTP是什么 

FTP就是文件传输协议。用于互联网双向传输，控制文件下载空间在服务器复制文件从本地计算机或本地上传文件复制到服务器上的空间。 

